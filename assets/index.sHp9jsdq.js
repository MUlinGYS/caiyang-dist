var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,a=(t,r,o)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,i=(e,t)=>{for(var r in t||(t={}))s.call(t,r)&&a(e,r,t[r]);if(o)for(var r of o(t))n.call(t,r)&&a(e,r,t[r]);return e},p=(e,o)=>t(e,r(o));import{a as c}from"./index.CyC1jm07.js";import{c as l}from"./index.CeC0tU_n.js";import{E as u}from"./emojo.Ben6gd8J.js";import{P as m}from"./vendor.FiRDnaVi.js";l();const d=c.create({timeout:15e3,baseURL:"http://60.204.231.249:8080",withCredentials:!0,transformRequest:[e=>JSON.stringify(e)],validateStatus:e=>e>=200&&e<300,headers:{get:{"Content-Type":"application/json"},post:{"Content-Type":"application/json"},delete:{"Content-Type":"application/json"},put:{"Content-Type":"application/json"}},transformResponse:[(e,t)=>{const r=t["content-type"];if(r&&r.includes("application/json"))try{return JSON.parse(e)}catch(o){return e}return e}]});function f(e){return t=this,r=null,o=function*(){var t,r;"POST"!==(null==(t=e.method)?void 0:t.toUpperCase())&&"PUT"!==(null==(r=e.method)?void 0:r.toUpperCase())||e.params&&!e.data&&(e.data=e.params,e.params=void 0);try{return(yield d.request(i({},e))).data}catch(o){return c.isAxiosError(o),Promise.reject(o)}},new Promise(((e,s)=>{var n=e=>{try{i(o.next(e))}catch(t){s(t)}},a=e=>{try{i(o.throw(e))}catch(t){s(t)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,a);i((o=o.apply(t,r)).next())}));var t,r,o}d.interceptors.request.use((e=>{var t;const r=localStorage.getItem("sys-v2.2.5");let o="";if(r){o=(null==(t=JSON.parse(r).user)?void 0:t.accessToken)||""}return o&&e.headers.set({"Content-Type":"application/json","X-Authorization":`Bearer ${o}`}),e}),(e=>(m.error(`服务器异常！ ${u[500]}`),Promise.reject(e)))),d.interceptors.response.use((e=>e),(e=>{if(c.isCancel(e));else{const t=e.response;if(t){const{status:r,data:o}=t;if(401===r&&"Token has expired"===o.message||401===r&&"Authentication failed"===o.message){const t=l();return m.error("401 认证失败或令牌已过期，请重新登录"),t.logOut(),Promise.reject(e)}}}return Promise.reject(e)}));const y={get:e=>f(p(i({},e),{method:"GET"})),post:e=>f(p(i({},e),{method:"POST"})),put:e=>f(p(i({},e),{method:"PUT"})),del:e=>f(p(i({},e),{method:"DELETE"}))};export{y as a};
