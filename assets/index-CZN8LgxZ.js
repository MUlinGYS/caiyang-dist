var e=(e,s,t)=>new Promise(((a,l)=>{var o=e=>{try{i(t.next(e))}catch(s){l(s)}},r=e=>{try{i(t.throw(e))}catch(s){l(s)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(o,r);i((t=t.apply(e,s)).next())}));import{_ as s,b as t,c as a,S as l,d as o,u as r,e as i,f as n,l as d,g as u,U as c}from"./index-CiSzWpKk.js";import{d as g,Z as h,aS as p,r as v,f,aT as m,j as y,c as x,e as w,v as b,u as k,ag as _,a as T,M,x as $,o as B,b as L,w as I,ah as P,D as V,$ as C,ai as z,F as S,A as D,ak as X,a0 as E,C as F,m as U,aE as j,z as A,H,L as O,I as R,a3 as q,N as K,P as N,ay as Y}from"./vendor-D3DmZvU-.js";import{L as G}from"./LeftView-DXQYpde6.js";import"./lf_icon2-BRyz9ns7.js";const J=["innerHTML"],Z=s(g({__name:"DragVerify",props:{value:{type:Boolean,default:!1},width:{default:260},height:{default:44},text:{default:"按住滑块拖动"},successText:{default:"success"},background:{default:"#eee"},progressBarBg:{default:"#1385FF"},completedBg:{default:"#57D187"},circle:{type:Boolean,default:!1},radius:{default:"calc(var(--custom-radius) / 2 + 2px)"},handlerIcon:{default:"&#xea50;"},successIcon:{default:"&#xe621;"},handlerBg:{default:"#fff"},textSize:{default:"13px"},textColor:{default:"#333"}},emits:["handlerMove","update:value","passCallback"],setup(e,{expose:s,emit:t}){const a=t,l=e,o=h({isMoving:!1,x:0,isOk:!1}),{isOk:r}=p(o),i=v(),n=v(),d=v(),u=v();let c,g,L,I;const P=e=>{c=e.targetTouches[0].pageX,g=e.targetTouches[0].pageY},V=e=>{L=e.targetTouches[0].pageX,I=e.targetTouches[0].pageY,Math.abs(L-c)>Math.abs(I-g)&&e.preventDefault()};document.addEventListener("touchstart",P),document.addEventListener("touchmove",V,{passive:!1}),f((()=>{var e,s,t;null==(e=i.value)||e.style.setProperty("--textColor",l.textColor),null==(s=i.value)||s.style.setProperty("--width",Math.floor(l.width/2)+"px"),null==(t=i.value)||t.style.setProperty("--pwidth",-Math.floor(l.width/2)+"px"),document.addEventListener("touchstart",P),document.addEventListener("touchmove",V,{passive:!1})})),m((()=>{document.removeEventListener("touchstart",P),document.removeEventListener("touchmove",V)}));const C={left:"0",width:l.height+"px",height:l.height+"px",background:l.handlerBg},z={width:l.width+"px",height:l.height+"px",lineHeight:l.height+"px",background:l.background,borderRadius:l.circle?l.height/2+"px":l.radius},S={background:l.progressBarBg,height:l.height+"px",borderRadius:l.circle?l.height/2+"px 0 0 "+l.height/2+"px":l.radius},D={height:l.height+"px",width:l.width+"px",fontSize:l.textSize},X=y((()=>l.value?l.successText:l.text)),E=e=>{l.value||(o.isMoving=!0,d.value.style.transition="none",o.x=(e.pageX||e.touches[0].pageX)-parseInt(d.value.style.left.replace("px",""),10)),a("handlerMove")},F=e=>{if(o.isMoving&&!l.value){let s=(e.pageX||e.touches[0].pageX)-o.x;s>0&&s<=l.width-l.height?(d.value.style.left=s+"px",u.value.style.width=s+l.height/2+"px"):s>l.width-l.height&&(d.value.style.left=l.width-l.height+"px",u.value.style.width=l.width-l.height/2+"px",j())}},U=e=>{if(o.isMoving&&!l.value){(e.pageX||e.changedTouches[0].pageX)-o.x<l.width-l.height?(o.isOk=!0,d.value.style.left="0",d.value.style.transition="all 0.2s",u.value.style.width="0",o.isOk=!1):(d.value.style.transition="none",d.value.style.left=l.width-l.height+"px",u.value.style.width=l.width-l.height/2+"px",j()),o.isMoving=!1}},j=()=>{a("update:value",!0),o.isMoving=!1,u.value.style.background=l.completedBg,n.value.style["-webkit-text-fill-color"]="unset",n.value.style.animation="slidetounlock2 3s infinite",n.value.style.color="#fff",a("passCallback")};return s({reset:()=>{d.value.style.left="0",u.value.valueFormat.style.width="0",d.value.children[0].type=l.handlerIcon,n.value.style["-webkit-text-fill-color"]="transparent",n.value.style.animation="slidetounlock 3s infinite",n.value.style.color=l.background}}),(e,s)=>(B(),x("div",{ref_key:"dragVerify",ref:i,class:"drag_verify",style:z,onMousemove:F,onMouseup:U,onMouseleave:U,onTouchmove:F,onTouchend:U},[w("div",{class:b(["dv_progress_bar",{goFirst2:k(r)}]),ref_key:"progressBar",ref:u,style:S},null,2),w("div",{class:"dv_text",style:D,ref_key:"messageRef",ref:n},[e.$slots.textBefore?_(e.$slots,"textBefore",{key:0},void 0,!0):T("",!0),M(" "+$(X.value)+" ",1),e.$slots.textAfter?_(e.$slots,"textAfter",{key:1},void 0,!0):T("",!0)],512),w("div",{class:b(["dv_handler dv_handler_bg",{goFirst:k(r)}]),onMousedown:E,onTouchstart:E,ref_key:"handler",ref:d,style:C},[w("i",{class:"iconfont-sys",innerHTML:e.value?e.successIcon:e.handlerIcon},null,8,J)],34)],544))}}),[["__scopeId","data-v-40c71f03"]]),Q={class:"login"},W={class:"left-wrap"},ee={class:"right-wrap"},se={class:"top-right-wrap"},te={class:"iconfont-sys"},ae={class:"menu-txt"},le={key:0,class:"iconfont-sys icon-check"},oe={class:"header"},re={class:"login-wrap"},ie={class:"form"},ne={class:"title"},de={class:"sub-title"},ue={class:"drag-verify"},ce={class:"forget-password"},ge={style:{"margin-top":"30px"}},he={class:"footer"},pe=s(g({__name:"index",setup(s){const{t:g}=t(),p=a(),f=q(),m=v(!1),_=v(!1),J=l.name,pe=v(),ve=h({username:l.login.username,password:l.login.password,rememberPassword:!0}),fe=y((()=>({username:[{required:!0,message:g("login.placeholder[0]"),trigger:"blur"}],password:[{required:!0,message:g("login.placeholder[1]"),trigger:"blur"}]}))),me=v(!1),{width:ye}=o(),xe=r(),we=y((()=>xe.isDark)),be=()=>{},ke=()=>e(this,null,(function*(){pe.value&&(yield pe.value.validate((s=>e(this,null,(function*(){if(s){me.value=!0;const e=e=>new Promise((s=>setTimeout(s,e)));try{const s=yield c.login({body:JSON.stringify({username:ve.username,password:ve.password})});if(s.token){p.setToken(s.token,s.refreshToken);const t=yield c.getUserInfo();200===t.code&&p.setUserInfo(t.data),p.setLoginStatus(!0),yield e(1e3),_e(),f.push("/dashboard/console")}else N.error("登录失败，请检查用户名和密码")}finally{yield e(1e3),me.value=!1}}})))))})),_e=()=>{setTimeout((()=>{Y({title:g("login.success.title"),type:"success",showClose:!1,duration:2500,zIndex:1e4,message:`${g("login.success.message")}${J} !`})}),300)},{locale:Te}=t(),Me=e=>{Te.value!==e&&(Te.value=e,p.setLanguage(e))},$e=()=>{let{LIGHT:e,DARK:s}=i;n().switchTheme(r().systemThemeType===e?s:e)};return(e,s)=>{const t=G,a=X,l=z,o=P,r=F,i=E,n=Z,c=j,g=A("router-link"),h=R,p=C,v=K("ripple");return B(),x("div",Q,[w("div",W,[L(t)]),w("div",ee,[w("div",se,[w("div",{class:"btn theme-btn",onClick:$e},[w("i",te,$(k(we)?"":""),1)]),L(o,{onCommand:Me,"popper-class":"langDropDownStyle"},{dropdown:I((()=>[L(l,null,{default:I((()=>[(B(!0),x(S,null,D(k(d),(e=>(B(),x("div",{key:e.value,class:"lang-btn-item"},[L(a,{command:e.value,class:b({"is-selected":k(Te)===e.value})},{default:I((()=>[w("span",ae,$(e.label),1),k(Te)===e.value?(B(),x("i",le,"")):T("",!0)])),_:2},1032,["command","class"])])))),128))])),_:1})])),default:I((()=>[s[4]||(s[4]=w("div",{class:"btn language-btn"},[w("i",{class:"iconfont-sys icon-language"},"")],-1))])),_:1})]),w("div",oe,[s[5]||(s[5]=w("svg",{class:"icon","aria-hidden":"true"},[w("use",{"xlink:href":"#iconsys-zhaopian-copy"})],-1)),w("h1",null,$(k(J)),1)]),w("div",re,[w("div",ie,[w("h3",ne,$(e.$t("login.title")),1),w("p",de,$(e.$t("login.subTitle")),1),L(p,{ref_key:"formRef",ref:pe,model:k(ve),rules:k(fe),onKeyup:V(ke,["enter"]),style:{"margin-top":"25px"}},{default:I((()=>[L(i,{prop:"username"},{default:I((()=>[L(r,{placeholder:e.$t("login.placeholder[0]"),size:"large",modelValue:k(ve).username,"onUpdate:modelValue":s[0]||(s[0]=e=>k(ve).username=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),L(i,{prop:"password"},{default:I((()=>[L(r,{placeholder:e.$t("login.placeholder[1]"),size:"large",modelValue:k(ve).password,"onUpdate:modelValue":s[1]||(s[1]=e=>k(ve).password=e),modelModifiers:{trim:!0},type:"password",radius:"8px",autocomplete:"off"},null,8,["placeholder","modelValue"])])),_:1}),w("div",ue,[w("div",{class:b(["drag-verify-content",{error:!k(m)&&k(_)}])},[L(n,{ref:"dragVerify",value:k(m),"onUpdate:value":s[2]||(s[2]=e=>U(m)?m.value=e:null),width:k(ye)<500?328:438,text:e.$t("login.sliderText"),textColor:"var(--art-gray-800)",successText:e.$t("login.sliderSuccessText"),progressBarBg:k(u)("--el-color-primary"),background:"var(--art-gray-200)",handlerBg:"var(--art-main-bg-color)",onPass:be},null,8,["value","width","text","successText","progressBarBg"])],2),w("p",{class:b(["error-text",{"show-error-text":!k(m)&&k(_)}])},$(e.$t("login.placeholder[2]")),3)]),w("div",ce,[L(c,{modelValue:k(ve).rememberPassword,"onUpdate:modelValue":s[3]||(s[3]=e=>k(ve).rememberPassword=e)},{default:I((()=>[M($(e.$t("login.rememberPwd")),1)])),_:1},8,["modelValue"]),L(g,{to:"/forget-password"},{default:I((()=>[M($(e.$t("login.forgetPwd")),1)])),_:1})]),w("div",ge,[H((B(),O(h,{class:"login-btn",size:"large",type:"primary",onClick:ke,loading:k(me)},{default:I((()=>[M($(e.$t("login.btnText")),1)])),_:1},8,["loading"])),[[v]])]),w("div",he,[w("p",null,[M($(e.$t("login.noAccount"))+" ",1),L(g,{to:"/register"},{default:I((()=>[M($(e.$t("login.register")),1)])),_:1})])])])),_:1},8,["model","rules"])])])])])}}}),[["__scopeId","data-v-e774bc6d"]]);export{pe as default};
