var e=(e,a,s)=>new Promise(((t,l)=>{var o=e=>{try{i(s.next(e))}catch(a){l(a)}},r=e=>{try{i(s.throw(e))}catch(a){l(a)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,r);i((s=s.apply(e,a)).next())}));import{_ as a,b as s,c as t,S as l,d as o,u as r,e as i,f as n,l as d,g as u}from"./index.CeC0tU_n.js";import{d as c,Z as g,aS as p,r as h,f as v,aT as f,j as m,c as y,e as x,v as w,u as b,ag as k,a as _,M as T,x as M,o as B,b as $,w as L,ah as C,D as I,$ as P,ai as V,F as j,A as z,ak as S,a0 as D,C as U,m as X,aF as A,z as F,H as E,L as O,I as R,a3 as q,N as H,P as N,ay as J}from"./vendor.FiRDnaVi.js";import{L as K}from"./LeftView.YxxzzWlC.js";import{A as Y}from"./status.CvEe1zvM.js";import{a as G}from"./index.sHp9jsdq.js";import"./lf_icon2.B3MZUtHp.js";import"./index.CyC1jm07.js";import"./emojo.Ben6gd8J.js";const Z=["innerHTML"],Q=a(c({__name:"DragVerify",props:{value:{type:Boolean,default:!1},width:{default:260},height:{default:44},text:{default:"按住滑块拖动"},successText:{default:"success"},background:{default:"#eee"},progressBarBg:{default:"#1385FF"},completedBg:{default:"#57D187"},circle:{type:Boolean,default:!1},radius:{default:"calc(var(--custom-radius) / 2 + 2px)"},handlerIcon:{default:"&#xea50;"},successIcon:{default:"&#xe621;"},handlerBg:{default:"#fff"},textSize:{default:"13px"},textColor:{default:"#333"}},emits:["handlerMove","update:value","passCallback"],setup(e,{expose:a,emit:s}){const t=s,l=e,o=g({isMoving:!1,x:0,isOk:!1}),{isOk:r}=p(o),i=h(),n=h(),d=h(),u=h();let c,$,L,C;const I=e=>{c=e.targetTouches[0].pageX,$=e.targetTouches[0].pageY},P=e=>{L=e.targetTouches[0].pageX,C=e.targetTouches[0].pageY,Math.abs(L-c)>Math.abs(C-$)&&e.preventDefault()};document.addEventListener("touchstart",I),document.addEventListener("touchmove",P,{passive:!1}),v((()=>{var e,a,s;null==(e=i.value)||e.style.setProperty("--textColor",l.textColor),null==(a=i.value)||a.style.setProperty("--width",Math.floor(l.width/2)+"px"),null==(s=i.value)||s.style.setProperty("--pwidth",-Math.floor(l.width/2)+"px"),document.addEventListener("touchstart",I),document.addEventListener("touchmove",P,{passive:!1})})),f((()=>{document.removeEventListener("touchstart",I),document.removeEventListener("touchmove",P)}));const V={left:"0",width:l.height+"px",height:l.height+"px",background:l.handlerBg},j={width:l.width+"px",height:l.height+"px",lineHeight:l.height+"px",background:l.background,borderRadius:l.circle?l.height/2+"px":l.radius},z={background:l.progressBarBg,height:l.height+"px",borderRadius:l.circle?l.height/2+"px 0 0 "+l.height/2+"px":l.radius},S={height:l.height+"px",width:l.width+"px",fontSize:l.textSize},D=m((()=>l.value?l.successText:l.text)),U=e=>{l.value||(o.isMoving=!0,d.value.style.transition="none",o.x=(e.pageX||e.touches[0].pageX)-parseInt(d.value.style.left.replace("px",""),10)),t("handlerMove")},X=e=>{if(o.isMoving&&!l.value){let a=(e.pageX||e.touches[0].pageX)-o.x;a>0&&a<=l.width-l.height?(d.value.style.left=a+"px",u.value.style.width=a+l.height/2+"px"):a>l.width-l.height&&(d.value.style.left=l.width-l.height+"px",u.value.style.width=l.width-l.height/2+"px",F())}},A=e=>{if(o.isMoving&&!l.value){(e.pageX||e.changedTouches[0].pageX)-o.x<l.width-l.height?(o.isOk=!0,d.value.style.left="0",d.value.style.transition="all 0.2s",u.value.style.width="0",o.isOk=!1):(d.value.style.transition="none",d.value.style.left=l.width-l.height+"px",u.value.style.width=l.width-l.height/2+"px",F()),o.isMoving=!1}},F=()=>{t("update:value",!0),o.isMoving=!1,u.value.style.background=l.completedBg,n.value.style["-webkit-text-fill-color"]="unset",n.value.style.animation="slidetounlock2 3s infinite",n.value.style.color="#fff",t("passCallback")};return a({reset:()=>{d.value.style.left="0",u.value.valueFormat.style.width="0",d.value.children[0].type=l.handlerIcon,n.value.style["-webkit-text-fill-color"]="transparent",n.value.style.animation="slidetounlock 3s infinite",n.value.style.color=l.background}}),(e,a)=>(B(),y("div",{ref_key:"dragVerify",ref:i,class:"drag_verify",style:j,onMousemove:X,onMouseup:A,onMouseleave:A,onTouchmove:X,onTouchend:A},[x("div",{class:w(["dv_progress_bar",{goFirst2:b(r)}]),ref_key:"progressBar",ref:u,style:z},null,2),x("div",{class:"dv_text",style:S,ref_key:"messageRef",ref:n},[e.$slots.textBefore?k(e.$slots,"textBefore",{key:0},void 0,!0):_("",!0),T(" "+M(D.value)+" ",1),e.$slots.textAfter?k(e.$slots,"textAfter",{key:1},void 0,!0):_("",!0)],512),x("div",{class:w(["dv_handler dv_handler_bg",{goFirst:b(r)}]),onMousedown:U,onTouchstart:U,ref_key:"handler",ref:d,style:V},[x("i",{class:"iconfont-sys",innerHTML:e.value?e.successIcon:e.handlerIcon},null,8,Z)],34)],544))}}),[["__scopeId","data-v-40c71f03"]]),W=""+new URL("avatar.CVDCzv8T.png",import.meta.url).href;class ee{static login(e){return G.post({url:"/api/auth/login",data:JSON.parse(e.body)})}static getUserInfo(){return new Promise((e=>{e({code:200,message:"获取用户信息成功",data:{id:1,name:"采样平台",username:"采样平台",avatar:W,email:"3069394597@qq.com"}})}))}}const ae={class:"login"},se={class:"left-wrap"},te={class:"right-wrap"},le={class:"top-right-wrap"},oe={class:"iconfont-sys"},re={class:"menu-txt"},ie={key:0,class:"iconfont-sys icon-check"},ne={class:"header"},de={class:"login-wrap"},ue={class:"form"},ce={class:"title"},ge={class:"sub-title"},pe={class:"drag-verify"},he={class:"forget-password"},ve={style:{"margin-top":"30px"}},fe={class:"footer"},me=a(c({__name:"index",setup(a){const{t:c}=s(),p=t(),v=q(),f=h(!1),k=h(!1),G=l.name,Z=h(),W=g({username:l.login.username,password:l.login.password,rememberPassword:!0}),me=m((()=>({username:[{required:!0,message:c("login.placeholder[0]"),trigger:"blur"}],password:[{required:!0,message:c("login.placeholder[1]"),trigger:"blur"}]}))),ye=h(!1),{width:xe}=o(),we=r(),be=m((()=>we.isDark)),ke=()=>{},_e=()=>e(this,null,(function*(){Z.value&&(yield Z.value.validate((a=>e(this,null,(function*(){if(a){ye.value=!0;const e=e=>new Promise((a=>setTimeout(a,e)));try{const a=yield ee.login({body:JSON.stringify({username:W.username,password:W.password})});if(a.token){p.setToken(a.token,a.refreshToken);const s=yield ee.getUserInfo();s.code===Y.success&&p.setUserInfo(s.data),p.setLoginStatus(!0),yield e(1e3),Te(),v.push("/dashboard/console")}else N.error("登录失败，请检查用户名和密码")}finally{yield e(1e3),ye.value=!1}}})))))})),Te=()=>{setTimeout((()=>{J({title:c("login.success.title"),type:"success",showClose:!1,duration:2500,zIndex:1e4,message:`${c("login.success.message")}${G} !`})}),300)},{locale:Me}=s(),Be=e=>{Me.value!==e&&(Me.value=e,p.setLanguage(e))},$e=()=>{let{LIGHT:e,DARK:a}=i;n().switchTheme(r().systemThemeType===e?a:e)};return(e,a)=>{const s=K,t=S,l=V,o=C,r=U,i=D,n=Q,c=A,g=F("router-link"),p=R,h=P,v=H("ripple");return B(),y("div",ae,[x("div",se,[$(s)]),x("div",te,[x("div",le,[x("div",{class:"btn theme-btn",onClick:$e},[x("i",oe,M(b(be)?"":""),1)]),$(o,{onCommand:Be,"popper-class":"langDropDownStyle"},{dropdown:L((()=>[$(l,null,{default:L((()=>[(B(!0),y(j,null,z(b(d),(e=>(B(),y("div",{key:e.value,class:"lang-btn-item"},[$(t,{command:e.value,class:w({"is-selected":b(Me)===e.value})},{default:L((()=>[x("span",re,M(e.label),1),b(Me)===e.value?(B(),y("i",ie,"")):_("",!0)])),_:2},1032,["command","class"])])))),128))])),_:1})])),default:L((()=>[a[4]||(a[4]=x("div",{class:"btn language-btn"},[x("i",{class:"iconfont-sys icon-language"},"")],-1))])),_:1})]),x("div",ne,[a[5]||(a[5]=x("svg",{class:"icon","aria-hidden":"true"},[x("use",{"xlink:href":"#iconsys-zhaopian-copy"})],-1)),x("h1",null,M(b(G)),1)]),x("div",de,[x("div",ue,[x("h3",ce,M(e.$t("login.title")),1),x("p",ge,M(e.$t("login.subTitle")),1),$(h,{ref_key:"formRef",ref:Z,model:b(W),rules:b(me),onKeyup:I(_e,["enter"]),style:{"margin-top":"25px"}},{default:L((()=>[$(i,{prop:"username"},{default:L((()=>[$(r,{placeholder:e.$t("login.placeholder[0]"),size:"large",modelValue:b(W).username,"onUpdate:modelValue":a[0]||(a[0]=e=>b(W).username=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),$(i,{prop:"password"},{default:L((()=>[$(r,{placeholder:e.$t("login.placeholder[1]"),size:"large",modelValue:b(W).password,"onUpdate:modelValue":a[1]||(a[1]=e=>b(W).password=e),modelModifiers:{trim:!0},type:"password",radius:"8px",autocomplete:"off"},null,8,["placeholder","modelValue"])])),_:1}),x("div",pe,[x("div",{class:w(["drag-verify-content",{error:!b(f)&&b(k)}])},[$(n,{ref:"dragVerify",value:b(f),"onUpdate:value":a[2]||(a[2]=e=>X(f)?f.value=e:null),width:b(xe)<500?328:438,text:e.$t("login.sliderText"),textColor:"var(--art-gray-800)",successText:e.$t("login.sliderSuccessText"),progressBarBg:b(u)("--el-color-primary"),background:"var(--art-gray-200)",handlerBg:"var(--art-main-bg-color)",onPass:ke},null,8,["value","width","text","successText","progressBarBg"])],2),x("p",{class:w(["error-text",{"show-error-text":!b(f)&&b(k)}])},M(e.$t("login.placeholder[2]")),3)]),x("div",he,[$(c,{modelValue:b(W).rememberPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>b(W).rememberPassword=e)},{default:L((()=>[T(M(e.$t("login.rememberPwd")),1)])),_:1},8,["modelValue"]),$(g,{to:"/forget-password"},{default:L((()=>[T(M(e.$t("login.forgetPwd")),1)])),_:1})]),x("div",ve,[E((B(),O(p,{class:"login-btn",size:"large",type:"primary",onClick:_e,loading:b(ye)},{default:L((()=>[T(M(e.$t("login.btnText")),1)])),_:1},8,["loading"])),[[v]])]),x("div",fe,[x("p",null,[T(M(e.$t("login.noAccount"))+" ",1),$(g,{to:"/register"},{default:L((()=>[T(M(e.$t("login.register")),1)])),_:1})])])])),_:1},8,["model","rules"])])])])])}}}),[["__scopeId","data-v-f12a2709"]]);export{me as default};
